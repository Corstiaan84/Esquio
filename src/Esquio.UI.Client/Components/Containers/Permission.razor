@inject EsquioState esquioState

@if (Cascading)
{
    <CascadingValue Value="@hasPermission" Name="HasPermission">
        @ChildContent
    </CascadingValue>
}
else if (hasPermission)
{
    @ChildContent
}

@code {
    [Parameter] public PolicyAction Requires { get; set; }
    [Parameter] public PolicySubject Over { get; set; }
    [Parameter] public RenderFragment ChildContent { get; set; }
    [Parameter] public bool Cascading { get; set; }

    private bool hasPermission = false;

    protected override void OnInitialized()
    {
        hasPermission = esquioState.Policy.Can(Requires, Over);
    }
}
